# 新旧対比表ジェネレーター

Word文書の「変更前」と「変更後」を比較して、**新旧対比表**を自動で作成するツールです。

## 新旧対比表とは？

規程や契約書などの文書を改訂するとき、「どこがどう変わったのか」を一目で分かるようにした表のことです。

```
┌─────────────────────────┬─────────────────────────┐
│ 変更前                   │ 変更後                   │
├─────────────────────────┼─────────────────────────┤
│ 第5条(通勤手当)          │ 第5条(通勤手当)          │
│                         │                         │
│ 上限 50,000円            │ 上限 30,000円 ← 変更箇所 │
│                         │                         │
│ (なし)                   │ (6) 家族手当 ← 新規追加  │
└─────────────────────────┴─────────────────────────┘
```

---

## Claude Web で使う（推奨）

ブラウザ版のClaude（claude.ai）で最も簡単に利用できます。

### 初回セットアップ（1回だけ）

最初に、このスキルをClaude Webに登録する必要があります。

#### 手順1: skills.zip をダウンロード

このリポジトリの **[skills.zip](skills.zip)** をダウンロードしてください。

> GitHubで見ている場合は、ファイルをクリックして「Download」ボタンを押すだけです。

#### 手順2: Claude Webの設定画面を開く

1. [claude.ai](https://claude.ai) にアクセスしてログイン
2. 画面左下の自分のアカウント名をクリック
3. 「Settings（設定）」を選択
4. 左メニューから「**Profile（プロフィール）**」を選択
5. 「**Custom skills（カスタムスキル）**」セクションを探す

#### 手順3: skills.zip をアップロード

1. 「Custom skills」セクションの「**Add skill（スキルを追加）**」をクリック
2. ダウンロードした `skills.zip` を選択してアップロード
3. アップロードが完了すると、スキル一覧に「comparison-table-v2」が表示されます

#### 手順4: 設定完了の確認

- スキル一覧に「comparison-table-v2」が表示されていればOK
- 有効/無効の切り替えスイッチがONになっていることを確認

> **注意**: この初回セットアップは1回だけ行えばOKです。次回以降は「使い方」から始められます。

---

### 使い方（毎回の操作）

セットアップ完了後は、以下の3ステップで新旧対比表を作成できます。

#### ステップ1: ファイルをアップロード

[claude.ai](https://claude.ai) で新しいチャットを開き、比較したい2つのWord文書（.docx）をチャット画面にドラッグ＆ドロップしてください。

- **変更前のファイル**: 旧バージョンの文書
- **変更後のファイル**: 新バージョンの文書

#### ステップ2: Claudeに依頼

ファイルをアップロードしたら、以下のように依頼してください：

```
新旧対比表を作成して
```

または

```
この2つの文書を比較して新旧対比表を作って
```

> **ポイント**: Claudeが自動的に登録済みのスキルを認識し、対比表生成スクリプトを実行します。

#### ステップ3: 完成した対比表をダウンロード

Claudeが自動で対比表を生成し、ダウンロードリンクを表示します。クリックするだけでWord形式の対比表が手に入ります。

---

### Claude Web利用時の注意点

| 項目 | 説明 |
|------|------|
| **プラン** | Pro/Teamプラン推奨。無料プランでも利用可能ですが、長い文書の場合はPro以上が安定します |
| **ファイル形式** | Word形式（.docx）のみ対応。PDFは事前にWordに変換してください |
| **ファイルサイズ** | 一般的な規程や契約書（数十ページ程度）であれば問題ありません |
| **セッション** | 長時間経過するとセッションが切れることがあります。その場合は再度ファイルをアップロードしてください |
| **スキル更新** | 新バージョンがリリースされたら、新しい skills.zip をダウンロードして再アップロードしてください |

---

### トラブルシューティング（Claude Web）

#### スキルが認識されない場合

1. 設定画面でスキルが有効になっているか確認
2. ブラウザをリロードして再度試す
3. 一度スキルを削除して再アップロード

#### 「スキルが見つかりません」と言われる場合

1. このリポジトリから skills.zip を再ダウンロードして試す
2. 一度スキルを削除して再アップロード

#### 生成に時間がかかる場合

- 長い文書（100ページ以上）の場合は処理に時間がかかることがあります
- しばらく待っても完了しない場合は、文書を分割して試してください

---

## Claude Code / Cursor で使う（上級者向け）

より高度な使い方として、Claude CodeやCursorでも利用できます。大量のファイルを処理したい場合や、ワークフローに組み込みたい場合に便利です。

### セットアップ

1. このリポジトリをクローン
```bash
git clone <repository-url>
cd shinkyu
```

2. 依存関係をインストール
```bash
cd skills/comparison-table-v2/scripts
npm install
```

3. pandocをインストール（未インストールの場合）
```bash
# macOS
brew install pandoc

# Ubuntu/Debian
sudo apt-get install pandoc

# Windows (Chocolatey)
choco install pandoc
```

### コマンドラインでの実行

```bash
node skills/comparison-table-v2/scripts/comparison_docx_generator.js \
  <変更前ファイル.docx> \
  <変更後ファイル.docx> \
  <出力ファイル.docx> \
  "文書名" \
  "2025年1月6日"
```

**引数の説明:**
| 引数 | 必須 | 説明 |
|------|------|------|
| 変更前ファイル | ○ | 旧バージョンのdocxファイルパス |
| 変更後ファイル | ○ | 新バージョンのdocxファイルパス |
| 出力ファイル | - | 出力先パス（省略時: comparison_table.docx） |
| 文書名 | - | 表のタイトル（省略時: ファイル名から自動生成） |
| 日付 | - | 表示する日付（省略時: 今日の日付） |

### Claude Code での活用例

Claude Codeで以下のように依頼できます：

```
uploadsフォルダにある2つのdocxファイルを比較して新旧対比表を作成して
```

### Cursor での活用例

Cursorでプロジェクトを開いた状態で：

```
old.docx と new.docx を比較して新旧対比表を生成して
```

### 必要な環境

| ソフトウェア | バージョン | 用途 |
|------------|-----------|------|
| Node.js | 14以上 | スクリプト実行 |
| pandoc | 2.0以上 | Word文書の読み込み |
| npm | 6以上 | パッケージ管理 |

---

## 対応している文書形式

このツールは、さまざまな見出し形式を**自動で認識**します。手動での設定は不要です。

| 形式 | 例 | 説明 |
|------|-----|------|
| 法律形式 | 第1条、第2条、第3条の2 | 法令や規程でよく使われる形式 |
| 番号形式 | 1. (目的)、2. (定義) | 番号＋括弧見出しの形式 |
| 階層形式 | 1.1、1.2、2.1.1 | ドットで区切った階層番号 |
| 括弧形式 | (1)、(2)、（3） | 半角・全角どちらも対応 |
| 記号形式 | §1、■項目、【1】 | 記号を使った見出し |
| 英語形式 | Article 1、Section 2 | 英文規程にも対応 |

---

## 出力される対比表の見方

### 色と書式の意味

| 表示 | 意味 |
|------|------|
| **太字＋下線（黒）** | 変更前の内容（削除された部分） |
| **太字＋下線（赤）** | 変更後の内容（追加された部分） |
| **青字＋太字** | 新しく追加された項目 |
| **赤字＋取り消し線** | 削除された項目 |

### 特別な表示

| 表示 | 意味 |
|------|------|
| `(新規追加)` | この項目は新たに追加されました |
| `(削除)` | この項目は削除されました |
| `(条文追加)` | 条文ごと新しく追加されました |
| `(条文削除)` | 条文ごと削除されました |

---

## よくある質問

### 全般

#### Q: Claude Webで使うのが一番簡単ですか？

はい。初回のスキル登録さえ済ませれば、ブラウザでclaude.aiにアクセスして、ファイルをドラッグ＆ドロップするだけで使えます。

#### Q: どのくらいの分量の文書に対応していますか？

規程や契約書など、一般的なビジネス文書（数十ページ程度）であれば問題なく処理できます。

#### Q: PDFファイルは使えますか？

現在はWord形式（.docx）のみ対応しています。PDFの場合は、まずWordに変換してからご利用ください。

#### Q: 見出しの形式が混在していても大丈夫？

はい。複数の見出し形式が混在していても、自動で認識して適切に処理します。

#### Q: 変更がない部分も表示されますか？

いいえ。変更があった箇所のみが表示されます。これにより、変更点に集中して確認できます。

### Claude Web について

#### Q: スキルの登録は毎回必要ですか？

いいえ。初回に1回登録すれば、以降はファイルをアップロードして依頼するだけで使えます。

#### Q: 無料プランでも使えますか？

使えますが、長い文書や複雑な文書の場合はPro/Teamプランの方が安定して処理できます。

#### Q: スキルを更新するにはどうすればいいですか？

1. このリポジトリから最新の skills.zip をダウンロード
2. 設定画面で古いスキルを削除
3. 新しい skills.zip をアップロード

### Claude Code / Cursor について

#### Q: Claude Code や Cursor を使うメリットは？

- 大量のファイルを一括処理できる
- 自動化ワークフローに組み込める
- ローカル環境で完結するためセキュリティ面で安心
- 処理速度が速い

#### Q: pandocのインストールは必須ですか？

はい。Word文書をテキストに変換するために必要です。

---

## 技術的な詳細

より詳しい技術情報は、以下のファイルをご覧ください：

- [skills/comparison-table-v2/SKILL.md](skills/comparison-table-v2/SKILL.md) - 詳細な仕様書
- [skills/comparison-table-v2/README.md](skills/comparison-table-v2/README.md) - 技術概要

---

## バージョン

現在のバージョン: **v4.0** (2025-10-30)

### 主な機能
- 階層構造の自動解析（親子関係を理解）
- 12種類の見出しパターンを自動認識
- 項目番号順に正しく並べ替え
- 変更箇所のハイライト表示
- プロフェッショナルなWord形式で出力
