# 新旧対比表ジェネレーター

Word文書の「変更前」と「変更後」を比較して、**新旧対比表**を自動で作成するツールです。

## 新旧対比表とは？

規程や契約書などの文書を改訂するとき、「どこがどう変わったのか」を一目で分かるようにした表のことです。

```
┌─────────────────────────┬─────────────────────────┐
│ 変更前                   │ 変更後                   │
├─────────────────────────┼─────────────────────────┤
│ 第5条(通勤手当)          │ 第5条(通勤手当)          │
│                         │                         │
│ 上限 50,000円            │ 上限 30,000円 ← 変更箇所 │
│                         │                         │
│ (なし)                   │ (6) 家族手当 ← 新規追加  │
└─────────────────────────┴─────────────────────────┘
```

## 使い方（3ステップ）

### ステップ1: ファイルをアップロード

比較したい2つのWord文書（.docx）をアップロードしてください。

- **変更前のファイル**: 旧バージョンの文書
- **変更後のファイル**: 新バージョンの文書

### ステップ2: Claudeに依頼

アップロードしたら、Claudeに以下のように依頼してください：

```
新旧対比表を作成して
```

または

```
この2つの文書を比較して新旧対比表を作って
```

### ステップ3: 完成した対比表をダウンロード

Claudeが自動で対比表を生成し、ダウンロードリンクを表示します。

---

## 対応している文書形式

このツールは、さまざまな見出し形式を**自動で認識**します。手動での設定は不要です。

| 形式 | 例 | 説明 |
|------|-----|------|
| 法律形式 | 第1条、第2条、第3条の2 | 法令や規程でよく使われる形式 |
| 番号形式 | 1. (目的)、2. (定義) | 番号＋括弧見出しの形式 |
| 階層形式 | 1.1、1.2、2.1.1 | ドットで区切った階層番号 |
| 括弧形式 | (1)、(2)、（3） | 半角・全角どちらも対応 |
| 英語形式 | Article 1、Section 2 | 英文規程にも対応 |

---

## 出力される対比表の見方

### 色と書式の意味

| 表示 | 意味 |
|------|------|
| **太字＋下線（黒）** | 変更前の内容（削除された部分） |
| **太字＋下線（赤）** | 変更後の内容（追加された部分） |
| **青字＋太字** | 新しく追加された項目 |
| **赤字＋取り消し線** | 削除された項目 |

### 特別な表示

- `(新規追加)` ... この項目は新たに追加されました
- `(削除)` ... この項目は削除されました
- `(条文追加)` ... 条文ごと新しく追加されました
- `(条文削除)` ... 条文ごと削除されました

---

## よくある質問

### Q: どのくらいの分量の文書に対応していますか？

規程や契約書など、一般的なビジネス文書であれば問題なく処理できます。

### Q: PDFファイルは使えますか？

現在はWord形式（.docx）のみ対応しています。PDFの場合は、まずWordに変換してからご利用ください。

### Q: 見出しの形式が混在していても大丈夫？

はい。複数の見出し形式が混在していても、自動で認識して適切に処理します。

### Q: 変更がない部分も表示されますか？

いいえ。変更があった箇所のみが表示されます。これにより、変更点に集中して確認できます。

---

## 必要な環境

- Node.js
- pandoc（Word文書の読み込みに使用）

---

## 技術的な詳細

より詳しい技術情報は、以下のファイルをご覧ください：

- [skills/comparison-table-v2/SKILL.md](skills/comparison-table-v2/SKILL.md) - 詳細な仕様書
- [skills/comparison-table-v2/README.md](skills/comparison-table-v2/README.md) - 技術概要

---

## バージョン

現在のバージョン: **v4.0** (2025-10-30)

### 主な機能
- 階層構造の自動解析（親子関係を理解）
- 12種類の見出しパターンを自動認識
- 項目番号順に正しく並べ替え
- 変更箇所のハイライト表示
- プロフェッショナルなWord形式で出力
